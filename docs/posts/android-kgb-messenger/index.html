<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="This is a write up of an open source CTF practice challenge. The aim of this CTF is to learn how to reverse engineer an Android Application. You can find the CTF link here.
Note: This was originally written on Medium and has been converted to markdown using mediumexporter
Tools used   Apktool
  jd-gui
  Uber Apk Signer
  dex2jar
  Installing the application Make sure to connect the android phone with debugging mode enabled and then install the application." />
<meta name="keywords" content=", android, apktool, smali, writeup" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://harshitm98.github.io/posts/android-kgb-messenger/" />


    <title>
        
            Android CTF - KGB Messenger :: Harshit Maheshwari 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.dc0c6d657e388585559a3980932e4245ef02b501245bf0f6f59d42da824af8fb.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">



<meta itemprop="name" content="Android CTF - KGB Messenger">
<meta itemprop="description" content="This is a write up of an open source CTF practice challenge. The aim of this CTF is to learn how to reverse engineer an Android Application. You can find the CTF link here.
Note: This was originally written on Medium and has been converted to markdown using mediumexporter
Tools used   Apktool
  jd-gui
  Uber Apk Signer
  dex2jar
  Installing the application Make sure to connect the android phone with debugging mode enabled and then install the application."><meta itemprop="datePublished" content="2019-12-04T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-12-04T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1526"><meta itemprop="image" content="https://harshitm98.github.io/"/>
<meta itemprop="keywords" content="android,apktool,smali,writeup," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://harshitm98.github.io/"/>

<meta name="twitter:title" content="Android CTF - KGB Messenger"/>
<meta name="twitter:description" content="This is a write up of an open source CTF practice challenge. The aim of this CTF is to learn how to reverse engineer an Android Application. You can find the CTF link here.
Note: This was originally written on Medium and has been converted to markdown using mediumexporter
Tools used   Apktool
  jd-gui
  Uber Apk Signer
  dex2jar
  Installing the application Make sure to connect the android phone with debugging mode enabled and then install the application."/>




    <meta property="og:title" content="Android CTF - KGB Messenger" />
<meta property="og:description" content="This is a write up of an open source CTF practice challenge. The aim of this CTF is to learn how to reverse engineer an Android Application. You can find the CTF link here.
Note: This was originally written on Medium and has been converted to markdown using mediumexporter
Tools used   Apktool
  jd-gui
  Uber Apk Signer
  dex2jar
  Installing the application Make sure to connect the android phone with debugging mode enabled and then install the application." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://harshitm98.github.io/posts/android-kgb-messenger/" /><meta property="og:image" content="https://harshitm98.github.io/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-12-04T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2019-12-04T00:00:00&#43;00:00" /><meta property="og:site_name" content="Harshit Maheshwari" />







    <meta property="article:published_time" content="2019-12-04 00:00:00 &#43;0000 UTC" />









    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MTVN5X7DXW"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-MTVN5X7DXW', { 'anonymize_ip': false });
}
</script>


    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MTVN5X7DXW"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-MTVN5X7DXW', { 'anonymize_ip': false });
}
</script>

    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/fakebatman</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        8 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://harshitm98.github.io/posts/android-kgb-messenger/">Android CTF - KGB Messenger</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>This is a write up of an open source CTF practice challenge. The aim of this CTF is to learn how to reverse engineer an Android Application. You can find the CTF link <a href="https://github.com/tlamb96/kgb_messenger">here</a>.</p>
<p><em>Note: This was originally written on <a href="https://medium.com/@fake_batman_/android-ctf-kgb-messenger-d9069f4cedf8">Medium</a> and has been converted to markdown using <a href="https://github.com/xdamman/mediumexporter">mediumexporter</a></em></p>
<h3 id="tools-used">Tools used</h3>
<ul>
<li>
<p><a href="https://ibotpeaches.github.io/Apktool/">Apktool</a></p>
</li>
<li>
<p><a href="https://github.com/java-decompiler/jd-gui/releases/">jd-gui</a></p>
</li>
<li>
<p><a href="https://github.com/patrickfav/uber-apk-signer">Uber Apk Signer</a></p>
</li>
<li>
<p><a href="https://github.com/pxb1988/dex2jar/">dex2jar</a></p>
</li>
</ul>
<h3 id="installing-the-application"><strong>Installing the application</strong></h3>
<p>Make sure to connect the android phone with debugging mode enabled and then install the application.</p>
<p>adb install kgb-messenger.apk</p>
<h3 id="decoding-using-apktool">Decoding using Apktool</h3>
<p>Decode the APK using Apktool and output it into kgb-smali folder.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*Bi7Q_rVomlGzdFko5DJlIw.png" alt=""></p>
<h3 id="converting-the-apk-in-jar-format-using-dex2jar">Converting the apk in .jar format using dex2jar</h3>
<p>We convert to jar because then we can use <strong>JD-GUI</strong> to see Java code.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*c5DGqjKODExd_TJl" alt=""></p>
<p>Using <strong>JD-GUI</strong>, we open the kgb-jar.jar created by the dex2jar (previous command).</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*-PNbYjV-6jDsq1ISkKAvnA.png" alt="Note: I downloaded JD-GUI and created a directory called tools and move it to that directory">
<em><strong>Note</strong>: I downloaded JD-GUI and created a directory called tools and move it to that directory</em></p>
<h3 id="launching-the-app-now"><strong>Launching the app now</strong></h3>
<p>As soon as we launch the app we get this error.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*yXOwagk_u6Fq_PwrsdRXSw.jpeg" alt=""></p>
<p>To see what is causing this error, we need to see which Activity is being launched first. So we open AndroidManifest.xml which can be found inside kgb-smali (Files created by apktool)</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*abkleTtjpX__IeiSd2HShQ.png" alt=""></p>
<p>Using vim editor, we open AndroidManifest.xml</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*oVI2pqnG3OaqOWbwKL1JRA.png" alt="Snippet of part of AndroidManifest.xml">
<em>Snippet of part of AndroidManifest.xml</em></p>
<p>MainActivity is the activity that is launched first. So use JD-GUI to view MainActivity.class</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*nl_NWIixkGk4_K5bKXifGQ.png" alt=""></p>
<p>We can see, when the activity is created, two string values are checked. First str1 is checked if it equals to <em>Russia. <em>Similarly, str2</em></em> <strong>is checked if it equals to getResources().getString(<em>2131558400</em>).</strong> **The number is numerical representation for the value of string stored in <a href="https://developer.android.com/guide/topics/resources/string-resource">strings.xml</a> file.</p>
<p>Since we also have the .smali** **files inside smali folder created by Apktool, we open MainActivity.smali and locate this particular line getResources().getString(2131558400)</p>
<p>Before that we need to represent 2131558400 in hex format so that it becomes easier for us to find the value inside of smali code.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*u1KvXOorF9aFAI55s7l9hg.png" alt=""></p>
<p>So we open MainActivity.smali file using Vim editor.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*PbT0zbT5PyaccPDk" alt=""></p>
<p>Now, we try to locate the String resource which has the id 0x7f0d0000 and is being compared to str2.</p>
<p>We go to the **res/values <strong>directory and search where does 0x7f0d0000</strong> **occurs</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*pS-1flAXQrOjTtRRqtHoHA.png" alt=""></p>
<p>We see that the name is <strong>“User”</strong> and type is <strong>“string”</strong>. So we search for **“User” **and in strings.xml file the name=”User” has value encoded using Base64. We docode it.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*_5l9saOR-njueyJgldPSZQ.png" alt=""></p>
<h2 id="capturing-the-second-flag">Capturing the Second Flag</h2>
<p><em>To capture the second flag we need to go to the next activity, that is LoginActivity.</em></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*hI8Kajk8qBuNzrs2IQxABA.png" alt="onCreate method of MainActivity">
<em>onCreate method of MainActivity</em></p>
<p>In order to get to LoginActivity, we need to find a way to get through both if conditions or we could just remove them.</p>
<p>Let’s open the .smali version of MainActivity.class to remove the code responsible for both if conditions.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*eqJBxvnnE2HQL2tz" alt="Smali version of first condition">
<em>Smali version of first condition</em></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*LoOSIYFg4CN0OeVw" alt="Smali version of second condition">
<em>Smali version of second condition</em></p>
<h3 id="getting-rid-of-both-conditions">Getting rid of both conditions</h3>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*maA0rMCkgZiglXk_" alt="Selecting the code for removal">
<em>Selecting the code for removal</em></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*FEm9b0f8VqTC-5AU" alt="After removal">
<em>After removal</em></p>
<p><em>Note: Make sure after removing your code looks this and ends with goto :go_to_0</em></p>
<h3 id="building-the-apk">Building the apk</h3>
<p>After making the changes we need to build the apk. So we build the apk using Apktool.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*kZVaENKs7Wq_CZaSxLXuog.png" alt=""></p>
<h3 id="signing-the-apk">Signing the apk</h3>
<p>We cannot directly install the apk. We need to <a href="http://www.androiddocs.com/tools/publishing/app-signing.html">sign</a> them first. However, since we are not the original developers of this app, we will Uber Apk Signer for this purpose.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*S4gIFG1JJDynyUND" alt="Note: I downloaded Uber Apk Signer and created a directory called tools and move it to that directory">
<em><strong>Note:</strong> I downloaded Uber Apk Signer and created a directory called tools and move it to that directory</em></p>
<h3 id="installing-and-running-the-modified-apk">Installing and running the modified apk</h3>
<p>Now when we launch, we are directly taken to LoginActivity.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*iXBg8Htuw8wb2s7UUA3nWA.jpeg" alt=""></p>
<p>Now we have to find out what the username and password is. Let’s take a look at the source code again but this time for LoginActivity using JD-GUI</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*EhH3Q8kmfI9m3vGOml_Pxg.png" alt=""></p>
<p>Inside onLogin method, we have two edit text who are converted to string. EditText1 is converted to string n and EditText2 is converted to string o. Right now we do not know which EditText corresponds to username and password.</p>
<h3 id="finding-username">Finding username</h3>
<p>We look at the first nested if condition, string n is being compared to a resource with id 2131158450. So we convert it to hex code again and check if we can find the corresponding string name.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*CuTQtfLwnPq9Ig-DFRx8Dg.png" alt="Finding the username value by using id which is found using hex code of 2131158450">
<em>Finding the <strong>username</strong> value by using id which is found using hex code of 2131158450</em></p>
<p>So the username is <strong>codenameduchess</strong>.</p>
<h3 id="finding-password">Finding password</h3>
<p>Let’s try to find the password using the same method used for username.</p>
<p>We go through the code again, and can see that function j should return false.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*1VnPhBbncBCYlqwqgiAONA.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*etHk9x6vEt-GcyS6fpqo7w.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*C9aaQCw1cJOEJ9hNA-vQLw.png" alt=""></p>
<p>Here, the string o is hashed using MD5 and then compared with string resource id 2131558446.</p>
<p>We try to find the value of hash from strings.xml and would use findmyhashto find its original value.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*iE1i-MlasrMZ50Z2TcBGtA.png" alt=""></p>
<p>We get hash value in the strings.xml, but when we try to use findmyhash to find the hash’s original value, we do not get any results.
The question did say that we would have to use social engineering to get the password. So we try googling <strong>codenameduchess</strong>.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*pQfTGuSgeW_bAWoS" alt="Google result for codenameduchess">
<em>Google result for codenameduchess</em></p>
<p>The name of account <strong>‘Sterling Archer’</strong> also checks out with the first flag. So we take a look at it’s twitter account.</p>
<p><img src="https://cdn-images-1.medium.com/max/2462/0*5efkfUlhLBwWccQC" alt="Twitter page for codenameduchess (Sterling Archer)">
<em>Twitter page for codenameduchess (Sterling Archer)</em></p>
<p>It looks like it is a character of a TV show. We now try to Google for codename duchess password.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*kCTg8tkgzelbTbQr" alt="Google result for codename duchess password">
<em>Google result for codename duchess password</em></p>
<p>We open the PDF, and search through it for password.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*RUhLhqm0GDv_H5va" alt=""></p>
<p>According to this, the password is <strong>Guest</strong>. So we input the password as ‘<strong>guest</strong>’ (all lowercase).</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*exESxY33phclNRn3z6I-mw.jpeg" alt=""></p>
<p>And..we are in. The Flag is <strong>G00G13_PR0</strong>.</p>
<h3 id="checking-the-value-of-hash">Checking the value of hash</h3>
<p>Just for fun, let’s see why could we not find the hash. So when we calculate the MD5 hash of guest, we get</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*XLjWrxUB6xRbFgBp" alt=""></p>
<p>So the reason we were not able to find the result was the hash we had was incomplete (did not have the zero at the start).</p>
<h2 id="capturing-the-third-flag">Capturing the third flag</h2>
<p><em>After logging in, we are taken to MessageActivity. There’s where we will find our third flag.</em></p>
<p>So we open MessageActivity using JD-GUI, we take a look at the source code.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*LMB1vOs34Zg_KVtC" alt="Function onSendMessage from MessageActivity">
<em>Function onSendMessage from MessageActivity</em></p>
<p>Whenever we send the message, onSendMessage function is called, and the text entered using EditText is converted to String str.</p>
<p>Now if we look closely, the string <strong>str</strong> is passed to a function named **a **on which equals function is called to check if it is equal to <strong>p</strong>.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*gzeSfauvA_nblVaC" alt=""></p>
<p>The value of <strong>p</strong> is:</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ftWhJr5rN_ZSA-rNzTEx6Q.png" alt=""></p>
<p>Now, let’s take a look at function a</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*serjcz7YzZkD70kI" alt=""></p>
<p>Function a** **returns string. In this function, the value of string passed as an argument obtained by:</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*WNgLkw-NgbZvZJ3sfACG8g.png" alt="Visual representation of the function a">
<em>Visual representation of the function a</em></p>
<p>So, the value of <strong>p</strong> equals to the parameter string passed to this function <strong>a</strong>. So, we can reverse engineer the original value of <strong>p</strong> by doing these steps in reverse. As we know (A XOR B) XOR B = A, we can use this to find the original value of the string:</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*vC6PV5N1cytGKcOEcW_lvw.png" alt="Visual representation of function where we XOR again">
<em>Visual representation of function where we XOR again</em></p>
<p>We recreate this above algorithm using Python:</p>
<pre><code>p = &quot;V@]EAASB\022WZF\022e,a$7(&amp;am2(3.\003&quot;
p = list(str(p))

for i in range(len(p) // 2):
	p[i] = chr(ord(p[i]) ^ 0x32)
	p[len(p) // 2 + 1 + i] = chr(ord(p[len(p) // 2 + 1 + i]) ^ 0x41)

p.reverse()
print(&quot;&quot;.join(p))
</code></pre><p>When we run this file, we get</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*e4tzOJ7YacoD7-fm" alt=""></p>
<p>So we enter this string as the input for the EditText of the app:</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*OdUTNQfQSU42HpxQlN-QsA.png" alt=""></p>
<p>Similarly, the input from the EditText is passed through function b and check if it equals to string r.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*Gr-cQn_dQSM88B4JbftQWQ.png" alt="The value of String r">
<em>The value of String r</em></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*kDT9QhVm015Q5pY6" alt="Function b whose returned value is compared to String r">
<em>Function b whose returned value is compared to String r</em></p>
<p>While converting the smali code to java class, there seems to be some problem. The code can be refactored so it can be better understood.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*LSNKMof9nI_hhx0W" alt="Just a readable version of function b">
<em>Just a readable version of function b</em></p>
<p>Here it is not possible to reverse engineer, so we try to brute force our way in. We check for what values of loop iterable i and alphabet, we get the output r.</p>
<pre><code>import string

r = &quot;\000dslp}oQ\000 dks$|M\000h +AYQg\000P*!M$gQ\000&quot;
r = list(str(r))
r.reverse()

for i in range(len(r)):
	if i % 8 == 0:
		print(&quot;_&quot;, end=&quot;&quot;)
		continue 
</code></pre><p>After running this file, we get the output.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*2l3YUXwHRTiocYUK" alt=""></p>
<p>The values for every 8th position is ‘_’ because we have i%8 == 0. And irrespective of the alphabets, the output from the function is 0, so it is difficult to find the answer using brute force.</p>
<p>So the message could be <strong>May I <em>PLEASE</em> have the password</strong>.</p>
<p>Let’s put this message</p>
<p><img src="https://cdn-images-1.medium.com/max/2160/1*Q3uWdINI9QQ9NF4EpMtaig.jpeg" alt=""></p>
<p>Third flag captured.</p>
<h3 id="why-did-not-directly-type-this-message-and-type-the-message-before">Why did not directly type this message and type the message before?</h3>
<p>To understand this, we need to see how the flag is calculated. Function i is responsible for calculating the flag. Let’s see how</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*6gHnhid59KUUj7mDg54lkw.png" alt=""></p>
<p>The first condition checks if String q and s are not null. That is they have to be initialized and set to some specific value. We cannot delete this if condition like before because we need values of q and s to calculate the flag.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*o-0u1INYr1chxf7yUPA-NQ.jpeg" alt="In function onSendMessage"><em>In function onSendMessage</em></p>
<p>It’s only after successfully sending both questions, the values for q and s are set. So it is necessary to send both messages.</p>
<p>So that’s my solution for this CTF. This was my first ever CTF and learned a lot during this challenge. Hope you also learned something.</p>
<p>Thanks for reading my write-up! Cheers! 🍺</p>
<p>Follow me on <a href="https://twitter.com/fake_batman_">Twitter</a>, <a href="https://github.com/harshitm98">Github</a> or connect on <a href="https://linkedin.com/in/harshitm98">LinkedIn</a>.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://harshitm98.github.io/tags/android/">android</a></span>
        <span class="tag"><a href="https://harshitm98.github.io/tags/apktool/">apktool</a></span>
        <span class="tag"><a href="https://harshitm98.github.io/tags/smali/">smali</a></span>
        <span class="tag"><a href="https://harshitm98.github.io/tags/writeup/">writeup</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1526 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2019-12-03 19:00
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Android%20CTF%20-%20KGB%20Messenger&amp;caption=Android%20CTF%20-%20KGB%20Messenger&amp;canonicalUrl=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Android%20CTF%20-%20KGB%20Messenger&amp;body=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f&amp;media=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f;description=Android%20CTF%20-%20KGB%20Messenger" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f&amp;title=Android%20CTF%20-%20KGB%20Messenger&amp;summary=Android%20CTF%20-%20KGB%20Messenger&amp;source=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f&amp;resubmit=true&amp;title=Android%20CTF%20-%20KGB%20Messenger" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f;title=Android%20CTF%20-%20KGB%20Messenger" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Android%20CTF%20-%20KGB%20Messenger%20https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f&amp;t=Android%20CTF%20-%20KGB%20Messenger" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Android%20CTF%20-%20KGB%20Messenger&amp;url=https%3a%2f%2fharshitm98.github.io%2fposts%2fandroid-kgb-messenger%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://harshitm98.github.io/posts/android-cybertruck19/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Android CTF - CyberTruck Challenge 2019 </span>
                </a>
            </span>
            

            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.72f3cdb1757e654c5aa1329a4269ea6a8d7b37513de3b9d54d7a5ca25573fb3a64f872d6c36cdb2acf759068fd27157cda3ac3827a42378d38946a025e58b6e6.js" integrity="sha512-cvPNsXV&#43;ZUxaoTKaQmnqao17N1E947nVTXpcolVz&#43;zpk&#43;HLWw2zbKs91kGj9JxV82jrDgnpCN404lGoCXli25g=="></script>



    </body>
</html>
